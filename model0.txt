
  model {
    for (i in 1:n_ind){
      Q[i,] ~ ddirich(alpha_q)
      for (m in 1:n_loc){
        for (c in 1:n_copies){
          Z[i,m,c,] ~ dmulti(Q[i,], 1)
          j <- 1*(Z[i,m,c,1] == 1) + 2*(Z[i,m,c,2] == 1) + 3*(Z[i,m,c,3] == 1)
          X[i,m,c,] ~ dmulti(P[j,m,], 1)
        }
      }
    }  
    for (j in 1:n_classes){
      for (m in 1:n_loc){
        P[j,m,] ~ ddirich(alpha_p)
      }
    }
  }

